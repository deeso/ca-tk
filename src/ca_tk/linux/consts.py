MASK_64_BITS = 0xffffffffffffffff
MASK_16_BITS = 0xffff

SIGNAL_LABELS = {
    1: 'SIGHUP',
    2: 'SIGINT',
    3: 'SIGQUIT',
    4: 'SIGILL',
    5: 'SIGTRAP',
    6: 'SIGABRT',
    6: 'SIGIOT',
    7: 'SIGBUS',
    8: 'SIGFPE',
    9: 'SIGKILL',
    10: 'SIGUSR1',
    11: 'SIGSEGV',
    12: 'SIGUSR2',
    13: 'SIGPIPE',
    14: 'SIGALRM',
    15: 'SIGTERM',
    16: 'SIGSTKFLT',
    17: 'SIGCHLD',
    18: 'SIGCONT',
    19: 'SIGSTOP',
    20: 'SIGTSTP',
    21: 'SIGTTIN',
    22: 'SIGTTOU',
    23: 'SIGURG',
    24: 'SIGXCPU',
    25: 'SIGXFSZ',
    26: 'SIGVTALRM',
    27: 'SIGPROF',
    28: 'SIGWINCH',
    29: 'SIGIO-SIGPOLL',
    30: 'SIGPWR',
    31: 'SIGSYS-SIGUNUSED',
    34: 'SIGRTMIN',
    35: 'SIGRTMIN+1',
    36: 'SIGRTMIN+2',
    37: 'SIGRTMIN+3',
    38: 'SIGRTMIN+4',
    39: 'SIGRTMIN+5',
    40: 'SIGRTMIN+6',
    41: 'SIGRTMIN+7',
    42: 'SIGRTMIN+8',
    43: 'SIGRTMIN+9',
    44: 'SIGRTMIN+10',
    45: 'SIGRTMIN+11',
    46: 'SIGRTMIN+12',
    47: 'SIGRTMIN+13',
    48: 'SIGRTMIN+14',
    49: 'SIGRTMIN+15',
    50: 'SIGRTMAX-14',
    51: 'SIGRTMAX-13',
    52: 'SIGRTMAX-12',
    53: 'SIGRTMAX-11',
    54: 'SIGRTMAX-10',
    55: 'SIGRTMAX-9',
    56: 'SIGRTMAX-8',
    57: 'SIGRTMAX-7',
    58: 'SIGRTMAX-6',
    59: 'SIGRTMAX-5',
    60: 'SIGRTMAX-4',
    61: 'SIGRTMAX-3',
    62: 'SIGRTMAX-2',
    63: 'SIGRTMAX-1',
    64: 'SIGRTMAX',

}

SIGNAL_ATTR = {
    9: '_kill',
    17: '_sigchld',
    4 : '_sigfault',
    8 : '_sigfault',
    11 : '_sigfault',
    7 : '_sigfault',
    29: '_sigpoll',
    31: '_sigsys',
    34: '_rt',
    35: '_rt',
    36: '_rt',
    37: '_rt',
    38: '_rt',
    39: '_rt',
    40: '_rt',
    41: '_rt',
    42: '_rt',
    43: '_rt',
    44: '_rt',
    45: '_rt',
    46: '_rt',
    47: '_rt',
    48: '_rt',
    49: '_rt',
    50: '_rt',
    51: '_rt',
    52: '_rt',
    53: '_rt',
    54: '_rt',
    55: '_rt',
    56: '_rt',
    57: '_rt',
    58: '_rt',
    59: '_rt',
    60: '_rt',
    61: '_rt',
    62: '_rt',
    63: '_rt',
    64: '_rt',
}


AUX_TYPES = {
    0:"AT_NULL", # /* end of vector */
    1:"AT_IGNORE", # /* entry should be ignored */
    2:"AT_EXECFD", # /* file descriptor of program */
    3:"AT_PHDR", # /* program headers for program */
    4:"AT_PHENT", # /* size of program header entry */
    5:"AT_PHNUM", # /* number of program headers */
    6:"AT_PAGESZ", # /* system page size */
    7:"AT_BASE", # /* base address of interpreter */
    8:"AT_FLAGS", # /* flags */
    9:"AT_ENTRY", # /* entry point of program */
    10:"AT_NOTELF", #    /* program is not ELF */
    11:"AT_UID", #    /* real uid */
    12:"AT_EUID", #    /* effective uid */
    13:"AT_GID", #    /* real gid */
    14:"AT_EGID", #    /* effective gid */
    15:"AT_PLATFORM", #  /* string identifying CPU for optimizations */
    16:"AT_HWCAP", #    /* arch dependent hints at CPU capabilities */
    17:"AT_CLKTCK", #    /* frequency at which times() increments */
    23:"AT_SECURE", #   /* secure mode boolean */
    24:"AT_BASE_PLATFORM", # /* string identifying real platform, may differ from AT_PLATFORM. */
    25:"AT_RANDOM", #    /* address of 16 random bytes */
    26:"AT_HWCAP2", #    /* extension of AT_HWCAP */
    31:"AT_EXECFN", #   /* filename of program */
    32:'AT_SYSINFO',
    33:'AT_SYSINFO_EHDR',

    18:'AT_RESERVED, Investigate, unknown',
    19:'AT_RESERVED, Investigate, unknown',
    20:'AT_RESERVED, Investigate, unknown',
    21:'AT_RESERVED, Investigate, unknown',
    22:'AT_RESERVED, Investigate, unknown',
    
    27:"WARNING: Investigate, unknown",
    28:"WARNING: Investigate, unknown",
    29:"WARNING: Investigate, unknown",
    30:"WARNING: Investigate, unknown",
}


# If the "orig_rax" register contains a value >= 0,
# it is interpreted as the system call number
# that the kernel is supposed to restart.

# Enum that defines the syscall identifiers for amd64 linux.
# Used for process record/replay, these will be translated into
# a gdb-canonical set of syscall ids in linux-record.c.

AMD64_SYSCALL = {
  0:"AMD64_SYS_READ",
  1:"AMD64_SYS_WRITE",
  2:"AMD64_SYS_OPEN",
  3:"AMD64_SYS_CLOSE",
  4:"AMD64_SYS_NEWSTAT",
  5:"AMD64_SYS_NEWFSTAT",
  6:"AMD64_SYS_NEWLSTAT",
  7:"AMD64_SYS_POLL",
  8:"AMD64_SYS_LSEEK",
  9:"AMD64_SYS_MMAP",
  10:"AMD64_SYS_MPROTECT",
  11:"AMD64_SYS_MUNMAP",
  12:"AMD64_SYS_BRK",
  13:"AMD64_SYS_RT_SIGACTION",
  14:"AMD64_SYS_RT_SIGPROCMASK",
  15:"AMD64_SYS_RT_SIGRETURN",
  16:"AMD64_SYS_IOCTL",
  17:"AMD64_SYS_PREAD64",
  18:"AMD64_SYS_PWRITE64",
  19:"AMD64_SYS_READV",
  20:"AMD64_SYS_WRITEV",
  21:"AMD64_SYS_ACCESS",
  22:"AMD64_SYS_PIPE",
  23:"AMD64_SYS_SELECT",
  24:"AMD64_SYS_SCHED_YIELD",
  25:"AMD64_SYS_MREMAP",
  26:"AMD64_SYS_MSYNC",
  27:"AMD64_SYS_MINCORE",
  28:"AMD64_SYS_MADVISE",
  29:"AMD64_SYS_SHMGET",
  30:"AMD64_SYS_SHMAT",
  31:"AMD64_SYS_SHMCTL",
  32:"AMD64_SYS_DUP",
  33:"AMD64_SYS_DUP2",
  34:"AMD64_SYS_PAUSE",
  35:"AMD64_SYS_NANOSLEEP",
  36:"AMD64_SYS_GETITIMER",
  37:"AMD64_SYS_ALARM",
  38:"AMD64_SYS_SETITIMER",
  39:"AMD64_SYS_GETPID",
  40:"AMD64_SYS_SENDFILE64",
  41:"AMD64_SYS_SOCKET",
  42:"AMD64_SYS_CONNECT",
  43:"AMD64_SYS_ACCEPT",
  44:"AMD64_SYS_SENDTO",
  45:"AMD64_SYS_RECVFROM",
  46:"AMD64_SYS_SENDMSG",
  47:"AMD64_SYS_RECVMSG",
  48:"AMD64_SYS_SHUTDOWN",
  49:"AMD64_SYS_BIND",
  50:"AMD64_SYS_LISTEN",
  51:"AMD64_SYS_GETSOCKNAME",
  52:"AMD64_SYS_GETPEERNAME",
  53:"AMD64_SYS_SOCKETPAIR",
  54:"AMD64_SYS_SETSOCKOPT",
  55:"AMD64_SYS_GETSOCKOPT",
  56:"AMD64_SYS_CLONE",
  57:"AMD64_SYS_FORK",
  58:"AMD64_SYS_VFORK",
  59:"AMD64_SYS_EXECVE",
  60:"AMD64_SYS_EXIT",
  61:"AMD64_SYS_WAIT4",
  62:"AMD64_SYS_KILL",
  63:"AMD64_SYS_UNAME",
  64:"AMD64_SYS_SEMGET",
  65:"AMD64_SYS_SEMOP",
  66:"AMD64_SYS_SEMCTL",
  67:"AMD64_SYS_SHMDT",
  68:"AMD64_SYS_MSGGET",
  69:"AMD64_SYS_MSGSND",
  70:"AMD64_SYS_MSGRCV",
  71:"AMD64_SYS_MSGCTL",
  72:"AMD64_SYS_FCNTL",
  73:"AMD64_SYS_FLOCK",
  74:"AMD64_SYS_FSYNC",
  75:"AMD64_SYS_FDATASYNC",
  76:"AMD64_SYS_TRUNCATE",
  77:"AMD64_SYS_FTRUNCATE",
  78:"AMD64_SYS_GETDENTS",
  79:"AMD64_SYS_GETCWD",
  80:"AMD64_SYS_CHDIR",
  81:"AMD64_SYS_FCHDIR",
  82:"AMD64_SYS_RENAME",
  83:"AMD64_SYS_MKDIR",
  84:"AMD64_SYS_RMDIR",
  85:"AMD64_SYS_CREAT",
  86:"AMD64_SYS_LINK",
  87:"AMD64_SYS_UNLINK",
  88:"AMD64_SYS_SYMLINK",
  89:"AMD64_SYS_READLINK",
  90:"AMD64_SYS_CHMOD",
  91:"AMD64_SYS_FCHMOD",
  92:"AMD64_SYS_CHOWN",
  93:"AMD64_SYS_FCHOWN",
  94:"AMD64_SYS_LCHOWN",
  95:"AMD64_SYS_UMASK",
  96:"AMD64_SYS_GETTIMEOFDAY",
  97:"AMD64_SYS_GETRLIMIT",
  98:"AMD64_SYS_GETRUSAGE",
  99:"AMD64_SYS_SYSINFO",
  100:"AMD64_SYS_TIMES",
  101:"AMD64_SYS_PTRACE",
  102:"AMD64_SYS_GETUID",
  103:"AMD64_SYS_SYSLOG",
  104:"AMD64_SYS_GETGID",
  105:"AMD64_SYS_SETUID",
  106:"AMD64_SYS_SETGID",
  107:"AMD64_SYS_GETEUID",
  108:"AMD64_SYS_GETEGID",
  109:"AMD64_SYS_SETPGID",
  110:"AMD64_SYS_GETPPID",
  111:"AMD64_SYS_GETPGRP",
  112:"AMD64_SYS_SETSID",
  113:"AMD64_SYS_SETREUID",
  114:"AMD64_SYS_SETREGID",
  115:"AMD64_SYS_GETGROUPS",
  116:"AMD64_SYS_SETGROUPS",
  117:"AMD64_SYS_SETRESUID",
  118:"AMD64_SYS_GETRESUID",
  119:"AMD64_SYS_SETRESGID",
  120:"AMD64_SYS_GETRESGID",
  121:"AMD64_SYS_GETPGID",
  122:"AMD64_SYS_SETFSUID",
  123:"AMD64_SYS_SETFSGID",
  124:"AMD64_SYS_GETSID",
  125:"AMD64_SYS_CAPGET",
  126:"AMD64_SYS_CAPSET",
  127:"AMD64_SYS_RT_SIGPENDING",
  128:"AMD64_SYS_RT_SIGTIMEDWAIT",
  129:"AMD64_SYS_RT_SIGQUEUEINFO",
  130:"AMD64_SYS_RT_SIGSUSPEND",
  131:"AMD64_SYS_SIGALTSTACK",
  132:"AMD64_SYS_UTIME",
  133:"AMD64_SYS_MKNOD",
  135:"AMD64_SYS_PERSONALITY",
  136:"AMD64_SYS_USTAT",
  137:"AMD64_SYS_STATFS",
  138:"AMD64_SYS_FSTATFS",
  139:"AMD64_SYS_SYSFS",
  140:"AMD64_SYS_GETPRIORITY",
  141:"AMD64_SYS_SETPRIORITY",
  142:"AMD64_SYS_SCHED_SETPARAM",
  143:"AMD64_SYS_SCHED_GETPARAM",
  144:"AMD64_SYS_SCHED_SETSCHEDULER",
  145:"AMD64_SYS_SCHED_GETSCHEDULER",
  146:"AMD64_SYS_SCHED_GET_PRIORITY_MAX",
  147:"AMD64_SYS_SCHED_GET_PRIORITY_MIN",
  148:"AMD64_SYS_SCHED_RR_GET_INTERVAL",
  149:"AMD64_SYS_MLOCK",
  150:"AMD64_SYS_MUNLOCK",
  151:"AMD64_SYS_MLOCKALL",
  152:"AMD64_SYS_MUNLOCKALL",
  153:"AMD64_SYS_VHANGUP",
  154:"AMD64_SYS_MODIFY_LDT",
  155:"AMD64_SYS_PIVOT_ROOT",
  156:"AMD64_SYS_SYSCTL",
  157:"AMD64_SYS_PRCTL",
  158:"AMD64_SYS_ARCH_PRCTL",
  159:"AMD64_SYS_ADJTIMEX",
  160:"AMD64_SYS_SETRLIMIT",
  161:"AMD64_SYS_CHROOT",
  162:"AMD64_SYS_SYNC",
  163:"AMD64_SYS_ACCT",
  164:"AMD64_SYS_SETTIMEOFDAY",
  165:"AMD64_SYS_MOUNT",
  166:"AMD64_SYS_UMOUNT",
  167:"AMD64_SYS_SWAPON",
  168:"AMD64_SYS_SWAPOFF",
  169:"AMD64_SYS_REBOOT",
  170:"AMD64_SYS_SETHOSTNAME",
  171:"AMD64_SYS_SETDOMAINNAME",
  172:"AMD64_SYS_IOPL",
  173:"AMD64_SYS_IOPERM",
  175:"AMD64_SYS_INIT_MODULE",
  176:"AMD64_SYS_DELETE_MODULE",
  179:"AMD64_SYS_QUOTACTL",
  180:"AMD64_SYS_NFSSERVCTL",
  186:"AMD64_SYS_GETTID",
  187:"AMD64_SYS_READAHEAD",
  188:"AMD64_SYS_SETXATTR",
  189:"AMD64_SYS_LSETXATTR",
  190:"AMD64_SYS_FSETXATTR",
  191:"AMD64_SYS_GETXATTR",
  192:"AMD64_SYS_LGETXATTR",
  193:"AMD64_SYS_FGETXATTR",
  194:"AMD64_SYS_LISTXATTR",
  195:"AMD64_SYS_LLISTXATTR",
  196:"AMD64_SYS_FLISTXATTR",
  197:"AMD64_SYS_REMOVEXATTR",
  198:"AMD64_SYS_LREMOVEXATTR",
  199:"AMD64_SYS_FREMOVEXATTR",
  200:"AMD64_SYS_TKILL",
  201:"AMD64_SYS_TIME",
  202:"AMD64_SYS_FUTEX",
  203:"AMD64_SYS_SCHED_SETAFFINITY",
  204:"AMD64_SYS_SCHED_GETAFFINITY",
  206:"AMD64_SYS_IO_SETUP",
  207:"AMD64_SYS_IO_DESTROY",
  208:"AMD64_SYS_IO_GETEVENTS",
  209:"AMD64_SYS_IO_SUBMIT",
  210:"AMD64_SYS_IO_CANCEL",
  212:"AMD64_SYS_LOOKUP_DCOOKIE",
  213:"AMD64_SYS_EPOLL_CREATE",
  216:"AMD64_SYS_REMAP_FILE_PAGES",
  217:"AMD64_SYS_GETDENTS64",
  218:"AMD64_SYS_SET_TID_ADDRESS",
  219:"AMD64_SYS_RESTART_SYSCALL",
  220:"AMD64_SYS_SEMTIMEDOP",
  221:"AMD64_SYS_FADVISE64",
  222:"AMD64_SYS_TIMER_CREATE",
  223:"AMD64_SYS_TIMER_SETTIME",
  224:"AMD64_SYS_TIMER_GETTIME",
  225:"AMD64_SYS_TIMER_GETOVERRUN",
  226:"AMD64_SYS_TIMER_DELETE",
  227:"AMD64_SYS_CLOCK_SETTIME",
  228:"AMD64_SYS_CLOCK_GETTIME",
  229:"AMD64_SYS_CLOCK_GETRES",
  230:"AMD64_SYS_CLOCK_NANOSLEEP",
  231:"AMD64_SYS_EXIT_GROUP",
  232:"AMD64_SYS_EPOLL_WAIT",
  233:"AMD64_SYS_EPOLL_CTL",
  234:"AMD64_SYS_TGKILL",
  235:"AMD64_SYS_UTIMES",
  237:"AMD64_SYS_MBIND",
  238:"AMD64_SYS_SET_MEMPOLICY",
  239:"AMD64_SYS_GET_MEMPOLICY",
  240:"AMD64_SYS_MQ_OPEN",
  241:"AMD64_SYS_MQ_UNLINK",
  242:"AMD64_SYS_MQ_TIMEDSEND",
  243:"AMD64_SYS_MQ_TIMEDRECEIVE",
  244:"AMD64_SYS_MQ_NOTIFY",
  245:"AMD64_SYS_MQ_GETSETATTR",
  246:"AMD64_SYS_KEXEC_LOAD",
  247:"AMD64_SYS_WAITID",
  248:"AMD64_SYS_ADD_KEY",
  249:"AMD64_SYS_REQUEST_KEY",
  250:"AMD64_SYS_KEYCTL",
  251:"AMD64_SYS_IOPRIO_SET",
  252:"AMD64_SYS_IOPRIO_GET",
  253:"AMD64_SYS_INOTIFY_INIT",
  254:"AMD64_SYS_INOTIFY_ADD_WATCH",
  255:"AMD64_SYS_INOTIFY_RM_WATCH",
  256:"AMD64_SYS_MIGRATE_PAGES",
  257:"AMD64_SYS_OPENAT",
  258:"AMD64_SYS_MKDIRAT",
  259:"AMD64_SYS_MKNODAT",
  260:"AMD64_SYS_FCHOWNAT",
  261:"AMD64_SYS_FUTIMESAT",
  262:"AMD64_SYS_NEWFSTATAT",
  263:"AMD64_SYS_UNLINKAT",
  264:"AMD64_SYS_RENAMEAT",
  265:"AMD64_SYS_LINKAT",
  266:"AMD64_SYS_SYMLINKAT",
  267:"AMD64_SYS_READLINKAT",
  268:"AMD64_SYS_FCHMODAT",
  269:"AMD64_SYS_FACCESSAT",
  270:"AMD64_SYS_PSELECT6",
  271:"AMD64_SYS_PPOLL",
  272:"AMD64_SYS_UNSHARE",
  273:"AMD64_SYS_SET_ROBUST_LIST",
  274:"AMD64_SYS_GET_ROBUST_LIST",
  275:"AMD64_SYS_SPLICE",
  276:"AMD64_SYS_TEE",
  277:"AMD64_SYS_SYNC_FILE_RANGE",
  278:"AMD64_SYS_VMSPLICE",
  279:"AMD64_SYS_MOVE_PAGES",
}


THREAD_MAPPING = {
    'pr_cstime':'cstime',
    'pr_cursig':'cursig',
    'pr_cutime':'cutime',
    'pr_flags':'flags',
    'pr_fpvalid':'fpvalid',
    'pr_pgrp':'pgrp',
    'pr_pid':'pid',
    'pr_ppid':'ppid',
    'pr_reg':'regs',
    'pr_sid':'sid',
    'pr_sighold':'sighold',
    'pr_sigpend':'sigpend',
    'pr_stime':'stime',
    'pr_utime':'utime',
    'pr_what':'what',
    'pr_why':'why',
    'fp_ctrl': 'fp_ctrl',
    'fp_stat': 'fp_stat',
    'fp_tag': 'fp_tag',
    'rsvrd': 'rsvrd',
    'fp_opcode': 'fp_opcode',
    'fp_inst_off': 'fp_inst_off',
    'fp_inst_seg': 'fp_inst_seg',
    'fp_data_off': 'fp_data_off',
    'fp_data_seg': 'fp_data_seg',
    'mxcsr': 'mxcsr',
    'mxcsr_mask': 'mxcsr_mask',
    'signal': 'signal',
    '_sigfields': 'sigfields',

}

PRPSINFO = {
  'pr_state': 'state', 
  'pr_sname': 'sname', 
  'pr_zomb': 'zomb', 
  'pr_nice': 'nice', 
  'pr_flag': 'flag', 
  'pr_uid': 'uid', 
  'pr_gid': 'gid', 
  'pr_pid': 'pid', 
  'pr_ppid': 'ppid', 
  'pr_pgrp': 'pgrp', 
  'pr_sid': 'sid', 
  'pr_fname': 'fname', 
  'pr_psargs': 'psargs', 
}


FP_REGS = {
    'st0': 'st0',
    'st1': 'st1',
    'st2': 'st2',
    'st3': 'st3',
    'st4': 'st4',
    'st5': 'st5',
    'st6': 'st6',
    'st7': 'st7',
    'xmm0': 'xmm0',
    'xmm1': 'xmm1',
    'xmm2': 'xmm2',
    'xmm3': 'xmm3',
    'xmm4': 'xmm4',
    'xmm5': 'xmm5',
    'xmm6': 'xmm6',
    'xmm7': 'xmm7',
    'xmm8': 'xmm8',
    'xmm9': 'xmm9',
    'xmm10': 'xmm10',
    'xmm11': 'xmm11',
    'xmm12': 'xmm12',
    'xmm13': 'xmm13',
    'xmm14': 'xmm14',
    'xmm15': 'xmm15',
    'st0_raw': 'st0_raw',
    'st1_raw': 'st1_raw',
    'st2_raw': 'st2_raw',
    'st3_raw': 'st3_raw',
    'st4_raw': 'st4_raw',
    'st5_raw': 'st5_raw',
    'st6_raw': 'st6_raw',
    'st7_raw': 'st7_raw',
}

DEFAULT_MEMORY_META = {
    'p_type': None, 
    'p_flags': 0, 
    'p_offset': -1, 
    'p_vaddr': -1, 
    'p_paddr': -1, 
    'p_filesz': -1, 
    'p_memsz': -1, 
    'p_align': -1,
    'vm_start': -1,
    'vm_end': -1,
    'vm_size': -1,
    'filename': b'NOT_SET',
    'loaded': False,
    'loadable': False,
    'requires_file': False,
    'page_offset': -1
}
